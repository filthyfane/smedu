{% extends 'base.nav.html.twig' %}

{% block title %}Conturi Curente{% endblock %}

{% block body %}

<div class="enrollment-wrapper">
  <h2>Conturi {{ current_year.getYearlabel|lower }}</h2>
  <br>
  {% if current_units is not empty %}
    {% for schoolunit in current_units %}
      <h3>Conturi {{ schoolunit.unitname|lower }} </h3>
      {% if schoolunit.getStudents is not empty %}
        <table id="accounts-{{ schoolunit.id }}" class="table table-striped table-hover">

          <thead>
            <tr>
              <th>Nume elev</th>
              <th>Facturi Neachitate</th>
              <th>Status</th>
              <th>Opționale</th>
              <th>Operațiuni</th>
              <th>Alertează</th>
            </tr>
          </thead>

          <tbody>
            {% for student in schoolunit.getStudents %}
              <tr>
                <!-- TODO: Sort by family name -->
                <td>{{ student.getUser.getFullName(1) }}</td>
                <td><code>for all year</code></td>
                <td><code>expiră la / alertă / achitat</code></td>
                <td>{{ student.getClassOptionals|length }}</td>
                <td>
                  <a href="{{ path('accounts_stud_month', {'monthYear':(date('-1 month')|localizeddate('none','none','ro', null, 'yyyy-MM')), 'studId':student.id}) }}">
                    <button type="button" class="btn btn-primary">{{ (date('-1 month')|localizeddate('none','none','ro', null, 'MMMM'))|capitalize }}</button>
                  </a>
                  <a href="{{ path('accounts_stud_month', {'monthYear':(date('now')|localizeddate('none','none','ro', null, 'yyyy-MM')), 'studId':student.id}) }}">
                    <button type="button" class="btn btn-warning">{{ (date()|localizeddate('none','none','ro', null, 'MMMM'))|capitalize }}</button>
                  </a>
                  <a href="{{ path('accounts') }}"><button type="button" class="btn btn-success">TOATE</button></a>
                </td>
                <td>
                  <i class="far fa-envelope"></i>
                </td>
              </tr>
            {% endfor %}
          </tbody>

        </table>
        <br>
      {% else %}
        <p>Nu există nicio înscriere în această unitate</p>
        <hr><br>
      {% endif %}
    {% endfor %}
  {% else %}
    <p>Nu există nicio unitate școlară definită în acest an școlar</p>
  {% endif %}


</div>

{% endblock %}
